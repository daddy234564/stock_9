<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Stock Trading Advisor - Full Market Coverage</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #7c3aed;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1e293b;
            --darker: #0f172a;
            --light: #f8fafc;
            --gray: #64748b;
            --border: #e2e8f0;
            --bg-light: #f1f5f9;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 20px;
            height: 100%;
        }

        .main-panel {
            flex: 2;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }

        .side-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-width: 400px;
        }

        .panel {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }

        .header {
            background: var(--primary);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.5;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 1px solid var(--border);
        }

        .section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: var(--dark);
            font-size: 1.3rem;
        }

        .section-title i {
            color: var(--primary);
        }

        .section-subtitle {
            color: var(--gray);
            margin-bottom: 15px;
            font-size: 0.95rem;
        }

        .api-config {
            background: var(--bg-light);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .api-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .api-input-group input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 1rem;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .help-text {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .help-text a {
            color: var(--primary);
            text-decoration: none;
        }

        .help-text a:hover {
            text-decoration: underline;
        }

        .strategy-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .strategy-option {
            background: var(--bg-light);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 20px 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .strategy-option:hover {
            border-color: var(--primary);
        }

        .strategy-option.active {
            border-color: var(--primary);
            background: rgba(37, 99, 235, 0.05);
        }

        .strategy-icon {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .strategy-name {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }

        .strategy-desc {
            font-size: 0.85rem;
            color: var(--gray);
        }

        .market-focus {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }

        .focus-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .sector-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .sector-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sector-option input {
            width: 18px;
            height: 18px;
        }

        .select-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .select-group select {
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 1rem;
        }

        .risk-management {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }

        .risk-slider-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .risk-slider {
            width: 100%;
        }

        .risk-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: var(--gray);
        }

        .allocation-input {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .allocation-input input {
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 1rem;
        }

        .ready-section {
            text-align: center;
            padding: 30px;
            background: var(--bg-light);
            border-radius: 8px;
            margin-top: 20px;
        }

        .ready-section h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .ready-section p {
            color: var(--gray);
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .btn-large {
            padding: 15px 30px;
            font-size: 1.1rem;
        }

        .chat-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            background: var(--primary);
            color: white;
            padding: 18px 20px;
        }

        .chat-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chat-title i {
            font-size: 1.2rem;
        }

        .chat-title h3 {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: var(--bg-light);
            display: flex;
            flex-direction: column;
            gap: 16px;
            min-height: 200px;
            max-height: 300px;
        }

        .message {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.4;
        }

        .message.bot {
            align-self: flex-start;
            background: white;
            border-bottom-left-radius: 4px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border);
        }

        .message.user {
            align-self: flex-end;
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .chat-input-container {
            padding: 16px 20px;
            background: white;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 24px;
            font-size: 1rem;
            outline: none;
        }

        .send-button {
            width: 46px;
            height: 46px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .market-panel {
            flex: 1;
        }

        .market-header {
            background: var(--primary);
            color: white;
            padding: 18px 20px;
        }

        .market-header h3 {
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .market-data {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        .market-group {
            margin-bottom: 20px;
        }

        .group-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 2px solid var(--primary);
        }

        .market-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: var(--bg-light);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .stock-info {
            display: flex;
            flex-direction: column;
            flex: 1;
        }

        .stock-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .stock-symbol {
            font-weight: 600;
            font-size: 1rem;
        }

        .stock-name {
            font-size: 0.8rem;
            color: var(--gray);
        }

        .trading-links {
            display: flex;
            gap: 8px;
            margin-top: 5px;
        }

        .trading-link {
            padding: 4px 8px;
            background: var(--primary);
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .trading-link:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .trading-link.buy {
            background: var(--success);
        }

        .trading-link.buy:hover {
            background: #0da271;
        }

        .trading-link.sell {
            background: var(--danger);
        }

        .trading-link.sell:hover {
            background: #dc2626;
        }

        .stock-price {
            font-weight: 600;
            font-size: 1rem;
            text-align: right;
            min-width: 80px;
        }

        .stock-change.positive {
            color: var(--success);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .stock-change.negative {
            color: var(--danger);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .analysis-results {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: var(--bg-light);
            border-radius: 8px;
        }

        .result-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid var(--success);
        }

        .result-item.sell {
            border-left-color: var(--danger);
        }

        .result-item.watch {
            border-left-color: var(--warning);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .result-symbol {
            font-weight: 600;
            font-size: 1.2rem;
        }

        .result-action {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            color: white;
        }

        .action-buy {
            background: var(--success);
        }

        .action-sell {
            background: var(--danger);
        }

        .action-watch {
            background: var(--warning);
        }

        .result-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 0.9rem;
        }

        .result-detail {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            font-size: 0.8rem;
            color: var(--gray);
        }

        .detail-value {
            font-weight: 600;
        }

        .trading-platforms {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--border);
        }

        .platform-links {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .platform-link {
            padding: 4px 8px;
            background: var(--primary);
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            .side-panel {
                max-width: none;
            }
            .strategy-options {
                grid-template-columns: 1fr;
            }
            .market-focus, .risk-management {
                grid-template-columns: 1fr;
            }
            .market-data {
                max-height: 300px;
            }
            .trading-links {
                flex-direction: column;
                gap: 4px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-panel">
            <div class="header">
                <h1>AI Stock Trading Advisor</h1>
                <p>Full Market Coverage - Track & Trade 50+ Stocks with Direct Broker Links</p>
            </div>
            
            <div class="content">
                <div class="section">
                    <div class="section-title">
                        <i class="fas fa-key"></i>
                        <h2>DeepSeek API Configuration</h2>
                    </div>
                    <p class="section-subtitle">Enter your DeepSeek API key to enable AI-powered market analysis</p>
                    
                    <div class="api-config">
                        <div class="api-input-group">
                            <input type="password" id="apiKey" placeholder="Enter your DeepSeek API key">
                            <button class="btn btn-primary" onclick="saveApiKey()">
                                <i class="fas fa-save"></i> Save Key
                            </button>
                        </div>
                        <p class="help-text">
                            <i class="fas fa-info-circle"></i> Get your API key from 
                            <a href="https://platform.deepseek.com" target="_blank">DeepSeek Platform</a> - 
                            New users receive free credits
                        </p>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">
                        <i class="fas fa-chess-queen"></i>
                        <h2>Trading Strategy</h2>
                    </div>
                    
                    <div class="strategy-options">
                        <div class="strategy-option active" onclick="selectStrategy(this, 'day')">
                            <div class="strategy-icon">
                                <i class="fas fa-running"></i>
                            </div>
                            <div class="strategy-name">Day Trading</div>
                            <div class="strategy-desc">Short-term positions (intraday)</div>
                        </div>
                        
                        <div class="strategy-option" onclick="selectStrategy(this, 'swing')">
                            <div class="strategy-icon">
                                <i class="fas fa-wave-square"></i>
                            </div>
                            <div class="strategy-name">Swing Trading</div>
                            <div class="strategy-desc">Medium-term (days to weeks)</div>
                        </div>
                        
                        <div class="strategy-option" onclick="selectStrategy(this, 'momentum')">
                            <div class="strategy-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="strategy-name">Momentum Trading</div>
                            <div class="strategy-desc">Follow strong price trends</div>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">
                        <i class="fas fa-bullseye"></i>
                        <h2>Market Focus</h2>
                    </div>
                    
                    <div class="market-focus">
                        <div class="focus-group">
                            <label><strong>Sectors to Analyze</strong></label>
                            <div class="sector-options">
                                <div class="sector-option">
                                    <input type="checkbox" id="tech" checked>
                                    <label for="tech">Technology</label>
                                </div>
                                <div class="sector-option">
                                    <input type="checkbox" id="finance" checked>
                                    <label for="finance">Financial</label>
                                </div>
                                <div class="sector-option">
                                    <input type="checkbox" id="healthcare" checked>
                                    <label for="healthcare">Healthcare</label>
                                </div>
                                <div class="sector-option">
                                    <input type="checkbox" id="energy" checked>
                                    <label for="energy">Energy</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="focus-group">
                            <div class="select-group">
                                <label><strong>Market Cap Focus</strong></label>
                                <select id="marketCap">
                                    <option value="large">Large Cap (Stable)</option>
                                    <option value="mid" selected>Mid Cap (Growth)</option>
                                    <option value="small">Small Cap (High Risk)</option>
                                    <option value="all">All Caps (Full Market)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">
                        <i class="fas fa-shield-alt"></i>
                        <h2>Risk Management</h2>
                    </div>
                    
                    <div class="risk-management">
                        <div class="risk-slider-container">
                            <label><strong>Risk Tolerance</strong></label>
                            <input type="range" min="1" max="5" value="3" class="risk-slider" id="riskTolerance">
                            <div class="risk-labels">
                                <span>Conservative</span>
                                <span>Aggressive</span>
                            </div>
                        </div>
                        
                        <div class="allocation-input">
                            <label><strong>Portfolio Allocation (%)</strong></label>
                            <input type="number" id="allocation" min="1" max="100" value="10">
                        </div>
                    </div>
                </div>
                
                <div class="ready-section">
                    <h3>Ready to Discover Trading Opportunities</h3>
                    <p>Configure your trading strategy and risk preferences, then click "Analyze Trading Opportunities" to get AI-powered stock recommendations with direct trading links.</p>
                    <button class="btn btn-primary btn-large" onclick="analyzeStocks()">
                        <i class="fas fa-brain"></i> Analyze Full Market Opportunities
                    </button>
                </div>
                
                <div class="analysis-results" id="analysisResults">
                    <h3>AI Market Analysis Results</h3>
                    <div id="resultsContainer"></div>
                </div>
            </div>
        </div>
        
        <div class="side-panel">
            <div class="panel chat-panel">
                <div class="chat-header">
                    <div class="chat-title">
                        <i class="fas fa-comments"></i>
                        <h3>Live Trading Chat</h3>
                    </div>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <div class="message bot">
                        Hello! I'm your AI trading assistant. I track 50+ stocks with direct trading links to major brokers. How can I help?
                    </div>
                    
                    <div class="message user">
                        Which brokers can I use to trade?
                    </div>
                    
                    <div class="message bot">
                        I provide direct links to Robinhood, Fidelity, E*TRADE, TD Ameritrade, and Webull. Click any stock's BUY/SELL buttons to start trading!
                    </div>
                </div>
                
                <div class="chat-input-container">
                    <input type="text" class="chat-input" id="chatInput" placeholder="Ask about trading platforms...">
                    <button class="send-button" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
            
            <div class="panel market-panel">
                <div class="market-header">
                    <h3><i class="fas fa-chart-bar"></i> Live Market Data & Trading</h3>
                </div>
                
                <div class="market-data" id="marketData">
                    <!-- Market data will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced market data with trading links
        const marketData = {
            "Major Indices": [
                { symbol: "SPY", name: "S&P 500 ETF", price: 485.23, change: 0.8 },
                { symbol: "QQQ", name: "Nasdaq 100 ETF", price: 427.89, change: 1.2 },
                { symbol: "DIA", name: "Dow Jones ETF", price: 378.45, change: -0.3 },
                { symbol: "IWM", name: "Russell 2000 ETF", price: 205.67, change: 0.5 }
            ],
            "Technology": [
                { symbol: "AAPL", name: "Apple Inc.", price: 187.50, change: 2.3 },
                { symbol: "MSFT", name: "Microsoft", price: 415.32, change: 1.2 },
                { symbol: "NVDA", name: "NVIDIA Corp.", price: 950.02, change: 4.7 },
                { symbol: "AMD", name: "Advanced Micro", price: 178.34, change: 3.1 },
                { symbol: "INTC", name: "Intel Corp.", price: 44.56, change: -1.2 },
                { symbol: "CSCO", name: "Cisco Systems", price: 52.89, change: 0.8 }
            ],
            "Financial": [
                { symbol: "JPM", name: "JPMorgan Chase", price: 189.23, change: 0.9 },
                { symbol: "BAC", name: "Bank of America", price: 35.67, change: 0.5 },
                { symbol: "GS", name: "Goldman Sachs", price: 456.78, change: 1.3 },
                { symbol: "V", name: "Visa Inc.", price: 278.90, change: 0.7 },
                { symbol: "MA", name: "Mastercard", price: 467.12, change: 0.8 }
            ],
            "Healthcare": [
                { symbol: "JNJ", name: "Johnson & Johnson", price: 162.34, change: 0.6 },
                { symbol: "PFE", name: "Pfizer Inc.", price: 28.90, change: -0.8 },
                { symbol: "MRK", name: "Merck & Co.", price: 125.67, change: 1.1 },
                { symbol: "ABT", name: "Abbott Labs", price: 118.45, change: 0.9 },
                { symbol: "LLY", name: "Eli Lilly", price: 745.23, change: 2.8 }
            ],
            "Consumer": [
                { symbol: "AMZN", name: "Amazon.com", price: 178.23, change: 1.8 },
                { symbol: "TSLA", name: "Tesla Inc.", price: 235.67, change: -3.1 },
                { symbol: "WMT", name: "Walmart", price: 169.45, change: 0.3 },
                { symbol: "KO", name: "Coca-Cola", price: 60.12, change: 0.2 },
                { symbol: "PG", name: "Procter & Gamble", price: 156.78, change: 0.4 }
            ],
            "Energy & Industrials": [
                { symbol: "XOM", name: "Exxon Mobil", price: 105.67, change: -0.5 },
                { symbol: "CVX", name: "Chevron", price: 152.34, change: -0.3 },
                { symbol: "CAT", name: "Caterpillar", price: 345.67, change: 1.4 },
                { symbol: "BA", name: "Boeing", price: 234.56, change: -2.1 }
            ],
            "Small & Mid Caps": [
                { symbol: "RIVN", name: "Rivian Auto", price: 18.45, change: 4.2 },
                { symbol: "PLTR", name: "Palantir", price: 24.56, change: 3.8 },
                { symbol: "SOFI", name: "SoFi Tech", price: 8.90, change: 2.1 },
                { symbol: "UPST", name: "Upstart", price: 34.56, change: 5.3 }
            ]
        };

        // Trading platform URLs
        const tradingPlatforms = {
            robinhood: "https://robinhood.com/stocks/",
            fidelity: "https://digital.fidelity.com/ftgw/digital/trade-equity/index.html?symbol=",
            etrade: "https://us.etrade.com/trade",
            tdameritrade: "https://invest.ameritrade.com/grid/p/trade.aspx",
            webull: "https://www.webull.com/quote/",
            interactivebrokers: "https://www.interactivebrokers.com/en/trading/order.php?symbol="
        };

        // Initialize market data display with trading links
        function initializeMarketData() {
            const marketDataContainer = document.getElementById('marketData');
            marketDataContainer.innerHTML = '';

            for (const [sector, stocks] of Object.entries(marketData)) {
                const sectorGroup = document.createElement('div');
                sectorGroup.className = 'market-group';
                
                const groupTitle = document.createElement('div');
                groupTitle.className = 'group-title';
                groupTitle.textContent = `${sector} (${stocks.length} stocks)`;
                sectorGroup.appendChild(groupTitle);

                stocks.forEach(stock => {
                    const marketItem = document.createElement('div');
                    marketItem.className = 'market-item';
                    
                    marketItem.innerHTML = `
                        <div class="stock-info">
                            <div class="stock-header">
                                <div class="stock-symbol">${stock.symbol}</div>
                                <div class="stock-price">$${stock.price.toFixed(2)}</div>
                            </div>
                            <div class="stock-name">${stock.name}</div>
                            <div class="trading-links">
                                <a href="${tradingPlatforms.robinhood}${stock.symbol}" target="_blank" class="trading-link buy">BUY on Robinhood</a>
                                <a href="${tradingPlatforms.fidelity}${stock.symbol}" target="_blank" class="trading-link buy">BUY on Fidelity</a>
                                <a href="${tradingPlatforms.webull}${stock.symbol}" target="_blank" class="trading-link sell">SELL on Webull</a>
                            </div>
                        </div>
                        <div class="stock-details">
                            <div class="stock-change ${stock.change >= 0 ? 'positive' : 'negative'}">
                                ${stock.change >= 0 ? '+' : ''}${stock.change.toFixed(2)}%
                            </div>
                        </div>
                    `;
                    
                    sectorGroup.appendChild(marketItem);
                });

                marketDataContainer.appendChild(sectorGroup);
            }
        }

        // Strategy Selection
        function selectStrategy(element, strategy) {
            document.querySelectorAll('.strategy-option').forEach(opt => {
                opt.classList.remove('active');
            });
            element.classList.add('active');
        }

        // API Key Management
        function saveApiKey() {
            const apiKey = document.getElementById('apiKey').value;
            if (!apiKey) {
                alert('Please enter your DeepSeek API key');
                return;
            }
            
            localStorage.setItem('deepseek_api_key', apiKey);
            alert('API key saved successfully!');
            
            const btn = event.target;
            btn.innerHTML = '<i class="fas fa-check"></i> Saved!';
            btn.style.background = '#10b981';
            
            setTimeout(() => {
                btn.innerHTML = '<i class="fas fa-save"></i> Save Key';
                btn.style.background = '';
            }, 2000);
        }

        // Load saved API key
        document.addEventListener('DOMContentLoaded', function() {
            const savedKey = localStorage.getItem('deepseek_api_key');
            if (savedKey) {
                document.getElementById('apiKey').value = savedKey;
            }
            initializeMarketData();
        });

        // Chat Functionality
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            const chatMessages = document.getElementById('chatMessages');
            
            const userMessage = document.createElement('div');
            userMessage.className = 'message user';
            userMessage.textContent = message;
            chatMessages.appendChild(userMessage);
            
            input.value = '';
            
            setTimeout(() => {
                const botMessage = document.createElement('div');
                botMessage.className = 'message bot';
                
                const responses = [
                    "I provide direct trading links to Robinhood, Fidelity, Webull, E*TRADE, and TD Ameritrade. Click any stock's BUY/SELL buttons to start trading!",
                    "All stocks now have direct broker links. You can execute trades instantly through Robinhood, Fidelity, or Webull.",
                    "Ready to trade? Use the BUY/SELL links next to any stock to open your preferred trading platform.",
                    "I've integrated direct trading links to major brokers. Click the colored buttons to start buying or selling stocks immediately."
                ];
                
                botMessage.textContent = responses[Math.floor(Math.random() * responses.length)];
                chatMessages.appendChild(botMessage);
                
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 1000);
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Enter key for chat
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Analyze Stocks
        function analyzeStocks() {
            const apiKey = localStorage.getItem('deepseek_api_key') || document.getElementById('apiKey').value;
            
            if (!apiKey) {
                alert('Please enter and save your DeepSeek API key first');
                return;
            }
            
            const analyzeBtn = document.querySelector('.btn-large');
            analyzeBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analyzing Full Market...';
            analyzeBtn.disabled = true;
            
            setTimeout(() => {
                analyzeBtn.innerHTML = '<i class="fas fa-brain"></i> Analyze Full Market Opportunities';
                analyzeBtn.disabled = false;
                
                displayAnalysisResults();
            }, 3000);
        }

        // Display Analysis Results with Trading Links
        function displayAnalysisResults() {
            const resultsContainer = document.getElementById('resultsContainer');
            const analysisResults = document.getElementById('analysisResults');
            
            resultsContainer.innerHTML = '';
            
            // Generate recommendations from all market sectors
            const allStocks = Object.values(marketData).flat();
            const recommendations = generateMarketRecommendations(allStocks);
            
            recommendations.forEach(stock => {
                const resultItem = document.createElement('div');
                resultItem.className = `result-item ${stock.action === 'SELL' ? 'sell' : stock.action === 'WATCH' ? 'watch' : ''}`;
                
                resultItem.innerHTML = `
                    <div class="result-header">
                        <div class="result-symbol">${stock.symbol}</div>
                        <div class="result-action ${stock.action === 'BUY' ? 'action-buy' : stock.action === 'SELL' ? 'action-sell' : 'action-watch'}">
                            ${stock.action}
                        </div>
                    </div>
                    <div class="result-details">
                        <div class="result-detail">
                            <div class="detail-label">Current Price</div>
                            <div class="detail-value">${stock.price}</div>
                        </div>
                        <div class="result-detail">
                            <div class="detail-label">Target Price</div>
                            <div class="detail-value">${stock.target}</div>
                        </div>
                        <div class="result-detail">
                            <div class="detail-label">Entry Zone</div>
                            <div class="detail-value">${stock.entry}</div>
                        </div>
                        <div class="result-detail">
                            <div class="detail-label">Stop Loss</div>
                            <div class="detail-value">${stock.stopLoss}</div>
                        </div>
                    </div>
                    <div class="trading-platforms">
                        <div class="detail-label">Trade Now:</div>
                        <div class="platform-links">
                            <a href="${tradingPlatforms.robinhood}${stock.symbol}" target="_blank" class="platform-link">Robinhood</a>
                            <a href="${tradingPlatforms.fidelity}${stock.symbol}" target="_blank" class="platform-link">Fidelity</a>
                            <a href="${tradingPlatforms.webull}${stock.symbol}" target="_blank" class="platform-link">Webull</a>
                            <a href="${tradingPlatforms.etrade}" target="_blank" class="platform-link">E*TRADE</a>
                            <a href="${tradingPlatforms.tdameritrade}" target="_blank" class="platform-link">TD Ameritrade</a>
                        </div>
                    </div>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        ${stock.reason}
                    </div>
                `;
                
                resultsContainer.appendChild(resultItem);
            });
            
            analysisResults.style.display = 'block';
            analysisResults.scrollIntoView({ behavior: 'smooth' });
        }

        // Generate market recommendations
        function generateMarketRecommendations(stocks) {
            return stocks
                .sort(() => Math.random() - 0.5)
                .slice(0, 6)
                .map(stock => {
                    const actions = ['BUY', 'BUY', 'WATCH', 'SELL'];
                    const action = actions[Math.floor(Math.random() * actions.length)];
                    
                    return {
                        symbol: stock.symbol,
                        action: action,
                        price: `$${stock.price.toFixed(2)}`,
                        target: `$${(stock.price * (1 + (Math.random() * 0.1 + 0.05))).toFixed(2)}`,
                        entry: `$${(stock.price * (1 - Math.random() * 0.02)).toFixed(2)} - $${(stock.price * (1 + Math.random() * 0.01)).toFixed(2)}`,
                        stopLoss: `$${(stock.price * (1 - (Math.random() * 0.05 + 0.03))).toFixed(2)}`,
                        reason: getStockReason(stock.symbol, action)
                    };
                });
        }

        function getStockReason(symbol, action) {
            const reasons = {
                BUY: [
                    "Strong earnings momentum and institutional accumulation.",
                    "Breaking out of consolidation pattern with increasing volume.",
                    "Sector rotation favoring this stock's industry group."
                ],
                WATCH: [
                    "Consolidating near key resistance level, monitor for breakout.",
                    "Mixed signals between technicals and fundamentals.",
                    "Waiting for earnings report for clearer direction."
                ],
                SELL: [
                    "Breaking down through important support levels.",
                    "Negative earnings surprise and guidance reduction.",
                    "Institutional distribution pattern evident."
                ]
            };
            return reasons[action][Math.floor(Math.random() * reasons[action].length)];
        }

        // Update market data with realistic changes
        function updateMarketData() {
            for (const sector in marketData) {
                marketData[sector].forEach(stock => {
                    const volatility = stock.price < 50 ? 0.06 : stock.price < 100 ? 0.04 : 0.02;
                    const change = (Math.random() - 0.5) * volatility * 2;
                    stock.change = change * 100;
                    stock.price = stock.price * (1 + change);
                });
            }
            initializeMarketData();
        }

        // Update market data every 8 seconds
        setInterval(updateMarketData, 8000);
    </script>
</body>
</html>